"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CloudArtifact=void 0;const jsiiDeprecationWarnings=require("../../.warnings.jsii.js"),JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti"),cxschema=require("../../cloud-assembly-schema"),metadata_1=require("./metadata");class CloudArtifact{constructor(assembly,id,manifest){this.assembly=assembly,this.id=id,jsiiDeprecationWarnings.aws_cdk_lib_cx_api_CloudAssembly(assembly),jsiiDeprecationWarnings.aws_cdk_lib_cloud_assembly_schema_ArtifactManifest(manifest),this.manifest=manifest,this.messages=this.renderMessages(),this._dependencyIDs=manifest.dependencies||[]}static fromManifest(assembly,id,artifact){switch(jsiiDeprecationWarnings.aws_cdk_lib_cx_api_CloudAssembly(assembly),jsiiDeprecationWarnings.aws_cdk_lib_cloud_assembly_schema_ArtifactManifest(artifact),artifact.type){case cxschema.ArtifactType.AWS_CLOUDFORMATION_STACK:return new cloudformation_artifact_1.CloudFormationStackArtifact(assembly,id,artifact);case cxschema.ArtifactType.CDK_TREE:return new tree_cloud_artifact_1.TreeCloudArtifact(assembly,id,artifact);case cxschema.ArtifactType.ASSET_MANIFEST:return new asset_manifest_artifact_1.AssetManifestArtifact(assembly,id,artifact);case cxschema.ArtifactType.NESTED_CLOUD_ASSEMBLY:return new nested_cloud_assembly_artifact_1.NestedCloudAssemblyArtifact(assembly,id,artifact);default:return}}get dependencies(){return this._deps?this._deps:(this._deps=this._dependencyIDs.map(id=>{const dep=this.assembly.tryGetArtifact(id);if(!dep)throw new Error(`Artifact ${this.id} depends on non-existing artifact ${id}`);return dep}),this._deps)}findMetadataByType(type){const result=new Array;for(const path of Object.keys(this.manifest.metadata||{}))for(const entry of(this.manifest.metadata||{})[path])entry.type===type&&result.push({path,...entry});return result}renderMessages(){const messages=new Array;for(const[id,metadata]of Object.entries(this.manifest.metadata||{}))for(const entry of metadata){let level;switch(entry.type){case cxschema.ArtifactMetadataEntryType.WARN:level=metadata_1.SynthesisMessageLevel.WARNING;break;case cxschema.ArtifactMetadataEntryType.ERROR:level=metadata_1.SynthesisMessageLevel.ERROR;break;case cxschema.ArtifactMetadataEntryType.INFO:level=metadata_1.SynthesisMessageLevel.INFO;break;default:continue}messages.push({level,entry,id})}return messages}get hierarchicalId(){var _b;return(_b=this.manifest.displayName)!==null&&_b!==void 0?_b:this.id}}exports.CloudArtifact=CloudArtifact,_a=JSII_RTTI_SYMBOL_1,CloudArtifact[_a]={fqn:"aws-cdk-lib.cx_api.CloudArtifact",version:"2.8.0"};const asset_manifest_artifact_1=require("./artifacts/asset-manifest-artifact"),cloudformation_artifact_1=require("./artifacts/cloudformation-artifact"),nested_cloud_assembly_artifact_1=require("./artifacts/nested-cloud-assembly-artifact"),tree_cloud_artifact_1=require("./artifacts/tree-cloud-artifact");
//# sourceMappingURL=cloud-artifact.js.map
